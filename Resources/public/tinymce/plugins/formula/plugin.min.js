/*! formula 2015-11-16 */
tinymce.PluginManager.requireLangPack("formula","en,es,fr_FR"),tinymce.PluginManager.add("formula",function(a,b){function c(){function c(){var c=a.settings.language||"en",e="",f="";"img"==d.nodeName.toLowerCase()&&d.className.indexOf("fm-editor-equation")>-1&&(d.getAttribute("data-mlang")&&(e="&mlang="+d.getAttribute("data-mlang")),d.getAttribute("data-equation")&&(f="&equation="+d.getAttribute("data-equation")));var g='<iframe name="tinymceFormula" id="tinymceFormula" src="'+b+"/index.html?lang="+c+e+f+'" scrolling="no" frameborder="0"></iframe>';return g}var d=a.selection.getNode();win=a.windowManager.open({title:"Formula",width:900,height:610,html:c(),buttons:[{text:"Cancel",onclick:function(){this.parent().parent().close()}},{text:"Insert Formula",subtype:"primary",onclick:function(b){var c=this;window.frames.tinymceFormula&&window.frames.tinymceFormula.getData?window.frames.tinymceFormula.getData(function(b,d,e){b&&a.insertContent('<img class="fm-editor-equation" src="'+b+'" data-mlang="'+d+'" data-equation="'+encodeURIComponent(e)+'"/>'),c.parent().parent().close()}):c.parent().parent().close()}}]})}a.addButton("formula",{image:b+"/img/formula.png",tooltip:"Insert Formula",onclick:c,onPostRender:function(){var b=this;a.on("NodeChange",function(a){b.active(a.element.className.indexOf("fm-editor-equation")>-1&&"img"==a.element.nodeName.toLowerCase())})}})});